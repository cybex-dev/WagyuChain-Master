let _activeAccount = "0x0";

let _etherAccounts = [];

let web3 = null;

window.addEventListener('load', function () {
    if (typeof window.web3 !== 'undefined') {
        var parent = document.getElementById("alert-container");
        if (parent) {
            createAlertHtml("warning", 'Web 3 Providers Usage', 'Currently only local RPC services like Ganache is supported. You are not able to use Web-based providers like Meta Mask.');
        }
    }

    web3 = new Web3(new Web3.providers.HttpProvider("http://127.0.0.1:8545"));
    if (!web3.isConnected()) {
        alert('Cannot connected to local provider, is it running?');
    }
    $('#web3provider_connection')
        .text('Connected to Web3 Provider (Ganache)')
        .removeClass("alert-danger")
        .addClass("alert-success");

    // add navlink a tag events to hide account selector when on index tab
    document.getElementById("navbarSupportedContent-4").style.setProperty('display', 'none', 'important');
    document.querySelectorAll('ul.nav.navbar-nav > .nav-item > a.nav-link').forEach(function (item) {
        item.addEventListener('click', function (item2) {
            let arr = item2.target.href.match("#index");
            if (arr && arr.length === 1) {
                document.getElementById("navbarSupportedContent-4").style.setProperty('display', 'none', 'important');
                checkContractExists(deployAddress);
            } else {
                document.getElementById("navbarSupportedContent-4").style.setProperty('display', '', 'important');
            }
        });
    });
    populateAccountList();
});

let web3Contract = null;

let min_gas = '6600000';

let fromAddress = '';

let deployAddress = '';

let byteCode = '0x6080604052336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550615490806100536000396000f3fe60806040526004361061012a5760003560e01c80637b11b291116100ab578063a70304ce1161006f578063a70304ce14610a15578063a9dd6afe14610b45578063d14660c814610d3f578063d8c55be614610da4578063ec8a0a3c14610e15578063f11726a514610e905761012a565b80637b11b291146106725780637e55d59c146106e05780638f9d91051461073b5780639d2f41c5146109295780639d8d8aa6146109a45761012a565b80633c65fb41116100f25780633c65fb411461039f5780633c9bcccf146105285780636058b5521461058d5780636ebde950146105de57806376db4bf4146106475761012a565b8063097d9b951461012c5780630b0eda391461019d5780630c63c2d0146101fa5780631a695230146102f65780632799fccb1461033a575b005b34801561013857600080fd5b5061019b6004803603604081101561014f57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610ef5565b005b3480156101a957600080fd5b506101f8600480360360408110156101c057600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035151590602001909291905050506112e8565b005b34801561020657600080fd5b506102f46004803603608081101561021d57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291908035906020019064010000000081111561026457600080fd5b82018360208201111561027657600080fd5b8035906020019184600183028401116401000000008311171561029857600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019092919050505061161b565b005b6103386004803603602081101561030c57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050611a65565b005b34801561034657600080fd5b506103896004803603602081101561035d57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050611fb4565b6040518082815260200191505060405180910390f35b3480156103ab57600080fd5b50610526600480360360808110156103c257600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291908035906020019064010000000081111561040957600080fd5b82018360208201111561041b57600080fd5b8035906020019184600183028401116401000000008311171561043d57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290803590602001906401000000008111156104a057600080fd5b8201836020820111156104b257600080fd5b803590602001918460018302840111640100000000831117156104d457600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929050505061209f565b005b34801561053457600080fd5b506105776004803603602081101561054b57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506125cc565b6040518082815260200191505060405180910390f35b34801561059957600080fd5b506105dc600480360360208110156105b057600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506126b7565b005b3480156105ea57600080fd5b5061062d6004803603602081101561060157600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050612b76565b604051808215151515815260200191505060405180910390f35b34801561065357600080fd5b5061065c612d30565b6040518082815260200191505060405180910390f35b6106de6004803603606081101561068857600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050612d3d565b005b3480156106ec57600080fd5b506107396004803603604081101561070357600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035906020019092919050505061317e565b005b34801561074757600080fd5b5061078a6004803603602081101561075e57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050613425565b604051808d73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200189815260200188815260200187815260200186151515158152602001851515151581526020018473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019c5050505050505050505050505060405180910390f35b34801561093557600080fd5b506109626004803603602081101561094c57600080fd5b810190808035906020019092919050505061357f565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156109b057600080fd5b50610a13600480360360408110156109c757600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506135bb565b005b348015610a2157600080fd5b50610b43600480360360e0811015610a3857600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803590602001909291908035906020019092919080359060200190640100000000811115610abd57600080fd5b820183602082011115610acf57600080fd5b80359060200191846001830284011164010000000083111715610af157600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050613ae1565b005b348015610b5157600080fd5b50610d3d6004803603610120811015610b6957600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291908035906020019092919080359060200190640100000000811115610bfa57600080fd5b820183602082011115610c0c57600080fd5b80359060200191846020830284011164010000000083111715610c2e57600080fd5b919080806020026020016040519081016040528093929190818152602001838360200280828437600081840152601f19601f82011690508083019250505050505050919291929080351515906020019092919080359060200190640100000000811115610c9a57600080fd5b820183602082011115610cac57600080fd5b80359060200191846020830284011164010000000083111715610cce57600080fd5b919080806020026020016040519081016040528093929190818152602001838360200280828437600081840152601f19601f820116905080830192505050505050509192919290803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050613f53565b005b348015610d4b57600080fd5b50610da260048036036060811015610d6257600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291908035906020019092919050505061477b565b005b348015610db057600080fd5b50610e1360048036036040811015610dc757600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506149b1565b005b348015610e2157600080fd5b50610e8e60048036036060811015610e3857600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050614dfd565b005b348015610e9c57600080fd5b50610edf60048036036020811015610eb357600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050615287565b6040518082815260200191505060405180910390f35b818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614610f9057600080fd5b823373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614611094576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b83838073ffffffffffffffffffffffffffffffffffffffff16600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561119a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601e8152602001807f566574696e617269616e732063616e6e6f74206265207468652073616d65000081525060200191505060405180910390fd5b856005808111156111a757fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060060154141561125e576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b85600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060030160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050505050505050565b818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461138357600080fd5b823373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614611487576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b8360058081111561149457fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060060154141561154b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b83600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060080160016101000a81548160ff0219169083151502179055507f0a35584fb7e360bc5ca597680cdecc7ced101e357d2929e5f14a5708faef497b8585604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001821515151581526020019250505060405180910390a15050505050565b838073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146116b657600080fd5b843373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146117ba576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b85856000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600e0160008381526020019081526020016000206000015414611888576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601a8152602001807f4d65616c207265636f726420616c72656164792065786973747300000000000081525060200191505060405180910390fd5b8760058081111561189557fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060060154141561194c576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b604051806060016040528089815260200188815260200187815250600260008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600e0160008a81526020019081526020016000206000820151816000015560208201518160010190805190602001906119e0929190615372565b5060408201518160020155905050600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600d01889080600181540180825580915050906001820390600052602060002001600090919290919091505550505050505050505050565b808073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614611b0057600080fd5b81600260008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060080160019054906101000a900460ff16611bc3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f436f77206973206e6f7420666f722073616c650000000000000000000000000081525060200191505060405180910390fd5b600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060050154803414611c7b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f496e73756666696369656e742066756e6473000000000000000000000000000081525060200191505060405180910390fd5b83600580811115611c8857fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600601541415611d3f576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b6000600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020505033600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507f9d9f8dee205818414bdc412447826de8498cede62c943f209590a732b07876fb868233604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a1505050505050565b6000818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461205157600080fd5b600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600d0180549050915050919050565b838073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461213a57600080fd5b843373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461223e576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260198152602001807f596f7520617265206e6f742074686520636f772773207665740000000000000081525060200191505060405180910390fd5b85856000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206010016000838152602001908152602001600020600001541461230c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601d8152602001807f436865636b7570207265636f726420616c72656164792065786973747300000081525060200191505060405180910390fd5b8760058081111561231957fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006015414156123d0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b604051806060016040528089815260200188815260200187815250600260008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060100160008a8152602001908152602001600020600082015181600001556020820151816001019080519060200190612464929190615372565b506040820151816002019080519060200190612481929190615372565b50905050600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600f018890806001815401808255809150509060018203906000526020600020016000909192909190915055507fbc44d1182cc990891c266fd31f7e6ec9ae906756f5b45e5df8e49dc2721adf058988604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200180602001828103825283818151815260200191508051906020019080838360005b8381101561258657808201518184015260208101905061256b565b50505050905090810190601f1680156125b35780820380516001836020036101000a031916815260200191505b50935050505060405180910390a1505050505050505050565b6000818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461266957600080fd5b600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600b0180549050915050919050565b808073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461275257600080fd5b813373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614612856576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b8260058081111561286357fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060060154141561291a576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720726561647920666f7220736c6175676874657200000000000000000081525060200191505060405180910390fd5b6000600260008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006015490507f1b3e506251c2ebe4ce6320d1124b8831a6f478315347287ac43f0fa82e4b191485600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a17fe3382e3265f065b7828d4764b22c8b576c015ceabd006740ca130cafebc21395858260046005811115612b2057fe5b604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001838152602001828152602001935050505060405180910390a15050505050565b6000818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614612c1357600080fd5b82600580811115612c2057fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600601541415612cd7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060080160019054906101000a900460ff1692505050919050565b6000600180549050905090565b828073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614612dd857600080fd5b83836000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c016000838152602001908152602001600020600101541415612ea7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f5061727420646f6573206e6f742065786973740000000000000000000000000081525060200191505060405180910390fd5b600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600086815260200190815260200160002060040154803414612f73576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f496e73756666696369656e742066756e6473000000000000000000000000000081525060200191505060405180910390fd5b600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c016000888152602001908152602001600020505084600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600088815260200190815260200160002060000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507f1831135e73187fbb47bbe95cdf41901f8aea2c3d4721182be0e1a7397c792644878787604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a150505050505050565b818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461321957600080fd5b823373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461331d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b6000600260008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060060154905083600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600601819055507fe3382e3265f065b7828d4764b22c8b576c015ceabd006740ca130cafebc21395858286604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001838152602001828152602001935050505060405180910390a15050505050565b60026020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060040154908060050154908060060154908060080160009054906101000a900460ff16908060080160019054906101000a900460ff16908060080160029054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060090160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169080600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508c565b6001818154811061358c57fe5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461365657600080fd5b823373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461375a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16838073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff161415613860576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601c8152602001807f4c6f636174696f6e732063616e6e6f74206265207468652073616d650000000081525060200191505060405180910390fd5b8560058081111561386d57fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600601541415613924576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b6000600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905086600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507f1b3e506251c2ebe4ce6320d1124b8831a6f478315347287ac43f0fa82e4b1914888289604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a15050505050505050565b848073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614613b7c57600080fd5b853373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614613c80576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f496e76616c69642070726f63657373696e672061626174746f6972000000000081525060200191505060405180910390fd5b868680600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c016000838152602001908152602001600020600101541415613ce557600080fd5b6040518060e001604052808a73ffffffffffffffffffffffffffffffffffffffff1681526020018981526020018881526020018681526020018781526020018b815260200160001515815250600260008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c0160008a815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160010155604082015181600201556060820151816003019080519060200190613dfb929190615372565b506080820151816004015560a0820151816005015560c08201518160060160006101000a81548160ff021916908315150217905550905050600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600b018890806001815401808255809150509060018203906000526020600020016000909192909190915055507f580ef7999043974948382fd91ea90c7221d387804b08ff23f172946f99481ee589898d8d604051808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018481526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200194505050505060405180910390a15050505050505050505050565b88600073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614614058576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260168152602001807f436f7720616c726561647920726567697374657265640000000000000000000081525060200191505060405180910390fd5b898360018151811061406657fe5b60200260200101518460008151811061407b57fe5b60200260200101518073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16141580156140eb57508073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614155b801561412357508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614155b614195576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601e8152602001807f506172656e74732f6f6666737072696e6720686176652073616d65204944000081525060200191505060405180910390fd5b6040518061020001604052808e73ffffffffffffffffffffffffffffffffffffffff1681526020013373ffffffffffffffffffffffffffffffffffffffff1681526020018d73ffffffffffffffffffffffffffffffffffffffff1681526020018c73ffffffffffffffffffffffffffffffffffffffff1681526020018b81526020018a81526020016000600581111561422a57fe5b815260200189815260200188151581526020016000151581526020018760008151811061425357fe5b602002602001015173ffffffffffffffffffffffffffffffffffffffff1681526020018760018151811061428357fe5b602002602001015173ffffffffffffffffffffffffffffffffffffffff1681526020018673ffffffffffffffffffffffffffffffffffffffff16815260200160006040519080825280602002602001820160405280156142f25781602001602082028038833980820191505090505b50815260200160006040519080825280602002602001820160405280156143285781602001602082028038833980820191505090505b508152602001600060405190808252806020026020018201604052801561435e5781602001602082028038833980820191505090505b50815250600260008f73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060408201518160020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060608201518160030160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506080820151816004015560a0820151816005015560c0820151816006015560e08201518160070190805190602001906144f79291906153f2565b506101008201518160080160006101000a81548160ff0219169083151502179055506101208201518160080160016101000a81548160ff0219169083151502179055506101408201518160080160026101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506101608201518160090160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555061018082015181600a0160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506101a082015181600b01908051906020019061462f9291906153f2565b506101c082015181600d01908051906020019061464d9291906153f2565b506101e082015181600f01908051906020019061466b9291906153f2565b5090505060018d90806001815401808255809150509060018203906000526020600020016000909192909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550507f4a74374c4bf0d1c7ff231237d54ccaeebf9ace2decc23671483df84c45122311338e604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019250505060405180910390a150505050505050505050505050565b823373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461487f576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b83836000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600083815260200190815260200160002060010154141561494e576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f5061727420646f6573206e6f742065786973740000000000000000000000000081525060200191505060405180910390fd5b83600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600087815260200190815260200160002060040181905550505050505050565b818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614614a4c57600080fd5b600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614614bb2576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f496e76616c69642070726f63657373696e672061626174746f6972000000000081525060200191505060405180910390fd5b6000600260008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600601549050600580811115614c0557fe5b600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600601819055507f81c4f748f2b8251193f19677b64f6d41a2301d662639e52fe9740fdce53b995885600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1686604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a17fe3382e3265f065b7828d4764b22c8b576c015ceabd006740ca130cafebc213958582600580811115614da757fe5b604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001838152602001828152602001935050505060405180910390a15050505050565b828073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614614e9857600080fd5b83836000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c016000838152602001908152602001600020600101541415614f67576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f5061727420646f6573206e6f742065786973740000000000000000000000000081525060200191505060405180910390fd5b8585600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600082815260200190815260200160002060060160009054906101000a900460ff1615615040576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f5061727420616c726561647920736f6c6400000000000000000000000000000081525060200191505060405180910390fd5b6001600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600089815260200190815260200160002060060160006101000a81548160ff02191690831515021790555085600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600089815260200190815260200160002060000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600089815260200190815260200160002050507f8ca89f6c5215526144cf02a80f774b20d08f0268575bdef4d5e70827e79446fd8888604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a15050505050505050565b6000818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461532457600080fd5b600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600f0180549050915050919050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106153b357805160ff19168380011785556153e1565b828001600101855582156153e1579182015b828111156153e05782518255916020019190600101906153c5565b5b5090506153ee919061543f565b5090565b82805482825590600052602060002090810192821561542e579160200282015b8281111561542d578251825591602001919060010190615412565b5b50905061543b919061543f565b5090565b61546191905b8082111561545d576000816000905550600101615445565b5090565b9056fea165627a7a72305820355dcca43271e9d17ea9311cb90b14110ba22a0d230c8ba1230f61ea0cbe27f70029';

let eventOnBornEvent = null;
let eventOnCowTransferEvent = null;
let eventOnRelocatedEvent = null;
let eventOnStatusUpdate = null;
let eventOnVeterinarianVisit = null;
let eventOnSlaughteredEvent = null;
let eventOnPackagedEvent = null;
let eventOnDistributedEvent = null;
let eventOnSoldEvent = null;
let eventOnCowForSale = null;

let abi = [{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"newVetinarian","type":"address"}],"name":"setVetinarian","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"isForSale","type":"bool"}],"name":"setCowMarketStatus","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"id","type":"uint256"},{"name":"foodType","type":"string"},{"name":"quantity","type":"uint256"}],"name":"mealReceived","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"}],"name":"transfer","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[{"name":"cowAddress","type":"address"}],"name":"getNumberOfMeals","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"id","type":"uint256"},{"name":"status","type":"string"},{"name":"description","type":"string"}],"name":"checkupReceived","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"cowAddress","type":"address"}],"name":"getNumberOfParts","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"}],"name":"sendToAbattoir","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"cowAddress","type":"address"}],"name":"isForSale","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getNumberOfCows","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"partId","type":"uint256"},{"name":"newOwner","type":"address"}],"name":"transferPart","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"newStatus","type":"uint256"}],"name":"setStatus","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"cowMapping","outputs":[{"name":"id","type":"address"},{"name":"owner","type":"address"},{"name":"farm","type":"address"},{"name":"vetinarian","type":"address"},{"name":"rfid","type":"bytes32"},{"name":"value","type":"uint256"},{"name":"status","type":"uint256"},{"name":"isMale","type":"bool"},{"name":"forSale","type":"bool"},{"name":"parentMale","type":"address"},{"name":"parentFemale","type":"address"},{"name":"abattoir","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"cowIndex","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"newLocation","type":"address"}],"name":"relocate","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"worker","type":"address"},{"name":"packaging","type":"uint256"},{"name":"cowAddress","type":"address"},{"name":"partId","type":"uint256"},{"name":"rfid","type":"bytes32"},{"name":"value","type":"uint256"},{"name":"description","type":"string"}],"name":"addCowPart","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"_farm","type":"address"},{"name":"_vetinarian","type":"address"},{"name":"_rfid","type":"bytes32"},{"name":"_value","type":"uint256"},{"name":"_cowDims","type":"uint256[]"},{"name":"_isMale","type":"bool"},{"name":"parents","type":"address[]"},{"name":"abattoirAddress","type":"address"}],"name":"born","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"partId","type":"uint256"},{"name":"newValue","type":"uint256"}],"name":"setPartValue","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"butcher","type":"address"}],"name":"slaughtered","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"partId","type":"uint256"},{"name":"newOwner","type":"address"}],"name":"buyPart","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"cowAddress","type":"address"}],"name":"getNumberOfCheckups","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[],"payable":true,"stateMutability":"payable","type":"constructor"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":false,"name":"owner","type":"address"},{"indexed":false,"name":"cowAddress","type":"address"}],"name":"onBornEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"oldOwner","type":"address"},{"indexed":false,"name":"newOwner","type":"address"}],"name":"onCowTransferEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"oldLocation","type":"address"},{"indexed":false,"name":"newLocation","type":"address"}],"name":"onRelocatedEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"oldStatus","type":"uint256"},{"indexed":false,"name":"newStatus","type":"uint256"}],"name":"onStatusUpdate","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"status","type":"string"}],"name":"onVeterinarianVisit","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"abattoir","type":"address"},{"indexed":false,"name":"slaughteredBy","type":"address"}],"name":"onSlaughteredEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"partId","type":"uint256"},{"indexed":false,"name":"packagedBy","type":"address"},{"indexed":false,"name":"packageStation","type":"uint256"}],"name":"onPackagedEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"partId","type":"uint256"},{"indexed":false,"name":"recieveCentre","type":"address"}],"name":"onDistributedEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"partId","type":"uint256"}],"name":"onSoldEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"isForSale","type":"bool"}],"name":"onCowForSale","type":"event"}];

function initContract() {
    if (web3 == null) {
        console.log("web3 is null");
    }
    web3Contract = web3.eth.contract(abi);
}

function getWeb3Contract() {
    if (web3Contract === null) {
        initContract();
    }
    return web3Contract;
}

function initEventHooks() {
    if (web3Contract === null) {
        console.log("Contract is null, cannot add event hooks");
        return;
    }
    if (eventOnBornEvent === null) {
        eventOnBornEvent = web3Contract.onBornEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Event: Cow Born", "New cow added to blockchain at address (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnCowTransferEvent === null) {
        eventOnCowTransferEvent = web3Contract.onCowTransferEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Event: Cow Transferred", "Cow Transferred to (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnRelocatedEvent === null) {
        eventOnRelocatedEvent = web3Contract.onRelocatedEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Event: Cow Relocated", "Cow relocated to new farm (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnStatusUpdate === null) {
        eventOnStatusUpdate = web3Contract.onStatusUpdate(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Event: Status Update", "Cow's status has been updated (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnVeterinarianVisit === null) {
        eventOnVeterinarianVisit = web3Contract.onVeterinarianVisit(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Event: Vetinarian Visit", "New vetinarian checkup added (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnSlaughteredEvent === null) {
        eventOnSlaughteredEvent = web3Contract.onSlaughteredEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Event: Slaughter Event", "Cow sent to abottoir for processing (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnPackagedEvent === null) {
        eventOnPackagedEvent = web3Contract.onPackagedEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Event: Part Packaged", "Cow parts being packaged for distribution (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnDistributedEvent === null) {
        eventOnDistributedEvent = web3Contract.onDistributedEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Event: Parts distributed", "Cow parts distributed to buyer (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnSoldEvent === null) {
        eventOnSoldEvent = web3Contract.onSoldEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Event: Part Sold", "Cow part sold to buyer (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnCowForSale === null) {
        eventOnCowForSale = web3Contract.onCowForSale(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Event: Cow Market Status", "Cow market status changed (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
}

function setActiveAccount(newAccount) {
    _activeAccount = newAccount;
    dispatchEvent(new CustomEvent('activeAccountChanged', {detail: newAccount}));
    populateAccountList();
}

function getContractAtAddress() {
    if (!deployAddress || deployAddress === "") {
        console.log("Deploy Address empty, no contract available");
        return null;
    }
    web3Contract = getWeb3Contract().at(deployAddress);
    initEventHooks();
    return web3Contract;
}

function populateAccountList() {
    if (web3 == null) {
        console.log("web3 is null");
    }

    if (!document.getElementById("navbarProfiles")) {
        return;
    }
    // Clear stored profiles first
    $('#navbarProfiles').empty();

    // Add new profiles
    let profileDropdown = document.getElementById("navbarProfiles");
    web3.eth.accounts.forEach(account => {
        let a = document.createElement("a");
        a.classList.add("dropdown-item");
        if (_activeAccount === account) {
            a.classList.add("active");
        }
        a.href = "#";
        a.addEventListener('click', function () {
            setActiveAccount(a.text);
        });
        a.text = account;
        profileDropdown.appendChild(a);
    });

    if (web3.isAddress(_activeAccount)) {
        $('#activeAccountBalance').text(" " + web3.fromWei(web3.eth.getBalance(_activeAccount).toString(), 'ether'));
    } else {
        $('#activeAccountBalance').text(" ???");
    }
}

function createAlertHtml(type, title, text) {
    return "<div class=\"alert alert-" + type + " alert-dismissible fade show\" role=\"alert\">\n" +
        "  <strong>" + title + "</strong> " + text + ".\n" +
        "  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n" +
        "    <span aria-hidden=\"true\">&times;</span>\n" +
        "  </button>\n" +
        "</div>";
}

function addEntriesToSelect(select_id, entries) {
    let select = document.getElementById(select_id);
    for (let i = 0; i < entries.length; i++) {
        let option = document.createElement("option");
        option.text = entries[i];
        select.add(option, i + 1);
    }
};

function addEntryToSelect(select_id, entry, selected) {
    let select = document.getElementById(select_id);
    let option = document.createElement("option");
    option.text = entry;
    if(selected) {
        option.setAttribute("selected", "selected");
    }
    select.add(option, 0);
};

function getCowMapping() {
    web3Contract.cowMapping.call(function (err, res) {
        console.log("Err = " + err);
        console.log("Res = " + res);
    });
}

function addItemToList(listObject, itemValue) {
    let li = document.createElement("li");
    li.appendChild(document.createTextNode(itemValue));
    listObject.appendChild(li);
}

window.addEventListener('load', function () {
    // Get contract instance
    if (deployAddress === "" || web3.eth.getCode(deployAddress) === "0x") {
        document.querySelectorAll("a.btn.btn-primary").forEach(btn => btn.onclick = false)
    }
    getContractAtAddress();

    setActiveAccount(web3.eth.accounts[0] || _activeAccount);
    setEtherAccounts(web3.eth.accounts);

    populateAccountList();
});

window.addEventListener('activeAccountChanged', function (data) {
    let activeAccount = document.getElementById("navbarProfiles");
    if (activeAccount)
        activeAccount.parentElement.firstElementChild.textContent = data.detail;
});

function setEtherAccounts(etherAccounts) {
    _etherAccounts = etherAccounts;
    dispatchEvent(new CustomEvent('etherAccountsUpdated', {detail: etherAccounts}));
}

function validAddress(address) {
    return web3.isAddress(address);
}

function generateNewAddress(password) {
    return web3.personal.newAccount(password);
}