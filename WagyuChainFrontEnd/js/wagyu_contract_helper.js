let _activeAccount = "0x0";

let _etherAccounts = [];

let web3 = null;

window.addEventListener('load', function () {
    if (typeof window.web3 !== 'undefined') {
        web3 = new Web3(web3.currentProvider);
        alert("Metamask Connected");
    } else {
        web3 = new Web3(new Web3.providers.HttpProvider("http://127.0.0.1:8545"));
        if (!web3.isConnected()) {
            alert('Cannot connected to local provider, is it running?');
        }
    }
});

let web3Contract = null;

let min_gas = '6500000';

let fromAddress = '0x60E1AAae3da7e3aC1F754274648107cAa984D5e8';

let deployAddress = '0x1F73d74E1203989a8b35cD53F97bA5B7BA099c91';

let byteCode = '0x6080604052336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555061503c806100536000396000f3fe6080604052600436106100fe5760003560e01c80637e55d59c11610095578063a70304ce11610064578063a70304ce146108f4578063a9dd6afe14610a24578063d14660c814610c1e578063d8c55be614610c83578063ec8a0a3c14610cf4576100fe565b80637e55d59c146105bf5780638f9d91051461061a5780639d2f41c5146108085780639d8d8aa614610883576100fe565b80633c65fb41116100d15780633c65fb411461030e5780636058b552146104975780636ebde950146104e85780637b11b29114610551576100fe565b8063097d9b95146101005780630b0eda39146101715780630c63c2d0146101ce5780631a695230146102ca575b005b34801561010c57600080fd5b5061016f6004803603604081101561012357600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610d6f565b005b34801561017d57600080fd5b506101cc6004803603604081101561019457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803515159060200190929190505050611162565b005b3480156101da57600080fd5b506102c8600480360360808110156101f157600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291908035906020019064010000000081111561023857600080fd5b82018360208201111561024a57600080fd5b8035906020019184600183028401116401000000008311171561026c57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929080359060200190929190505050611495565b005b61030c600480360360208110156102e057600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506118df565b005b34801561031a57600080fd5b506104956004803603608081101561033157600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291908035906020019064010000000081111561037857600080fd5b82018360208201111561038a57600080fd5b803590602001918460018302840111640100000000831117156103ac57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561040f57600080fd5b82018360208201111561042157600080fd5b8035906020019184600183028401116401000000008311171561044357600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050611e2e565b005b3480156104a357600080fd5b506104e6600480360360208110156104ba57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061235b565b005b3480156104f457600080fd5b506105376004803603602081101561050b57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061281a565b604051808215151515815260200191505060405180910390f35b6105bd6004803603606081101561056757600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506129d4565b005b3480156105cb57600080fd5b50610618600480360360408110156105e257600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190505050612e15565b005b34801561062657600080fd5b506106696004803603602081101561063d57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506130bc565b604051808d73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200189815260200188815260200187815260200186151515158152602001851515151581526020018473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019c5050505050505050505050505060405180910390f35b34801561081457600080fd5b506108416004803603602081101561082b57600080fd5b8101908080359060200190929190505050613216565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561088f57600080fd5b506108f2600480360360408110156108a657600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050613252565b005b34801561090057600080fd5b50610a22600480360360e081101561091757600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035906020019092919080359060200190929190803590602001909291908035906020019064010000000081111561099c57600080fd5b8201836020820111156109ae57600080fd5b803590602001918460018302840111640100000000831117156109d057600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050613778565b005b348015610a3057600080fd5b50610c1c6004803603610120811015610a4857600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291908035906020019092919080359060200190640100000000811115610ad957600080fd5b820183602082011115610aeb57600080fd5b80359060200191846020830284011164010000000083111715610b0d57600080fd5b919080806020026020016040519081016040528093929190818152602001838360200280828437600081840152601f19601f82011690508083019250505050505050919291929080351515906020019092919080359060200190640100000000811115610b7957600080fd5b820183602082011115610b8b57600080fd5b80359060200191846020830284011164010000000083111715610bad57600080fd5b919080806020026020016040519081016040528093929190818152602001838360200280828437600081840152601f19601f820116905080830192505050505050509192919290803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050613bea565b005b348015610c2a57600080fd5b50610c8160048036036060811015610c4157600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035906020019092919080359060200190929190505050614412565b005b348015610c8f57600080fd5b50610cf260048036036040811015610ca657600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050614648565b005b348015610d0057600080fd5b50610d6d60048036036060811015610d1757600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050614a94565b005b818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614610e0a57600080fd5b823373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614610f0e576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b83838073ffffffffffffffffffffffffffffffffffffffff16600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415611014576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601e8152602001807f566574696e617269616e732063616e6e6f74206265207468652073616d65000081525060200191505060405180910390fd5b8560058081111561102157fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006015414156110d8576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b85600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060030160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050505050505050565b818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146111fd57600080fd5b823373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614611301576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b8360058081111561130e57fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006015414156113c5576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b83600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060080160016101000a81548160ff0219169083151502179055507f0a35584fb7e360bc5ca597680cdecc7ced101e357d2929e5f14a5708faef497b8585604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001821515151581526020019250505060405180910390a15050505050565b838073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461153057600080fd5b843373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614611634576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b85856000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600e0160008381526020019081526020016000206000015414611702576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601a8152602001807f4d65616c207265636f726420616c72656164792065786973747300000000000081525060200191505060405180910390fd5b8760058081111561170f57fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006015414156117c6576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b604051806060016040528089815260200188815260200187815250600260008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600e0160008a815260200190815260200160002060008201518160000155602082015181600101908051906020019061185a929190614f1e565b5060408201518160020155905050600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600d01889080600181540180825580915050906001820390600052602060002001600090919290919091505550505050505050505050565b808073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461197a57600080fd5b81600260008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060080160019054906101000a900460ff16611a3d576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f436f77206973206e6f7420666f722073616c650000000000000000000000000081525060200191505060405180910390fd5b600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060050154803414611af5576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f496e73756666696369656e742066756e6473000000000000000000000000000081525060200191505060405180910390fd5b83600580811115611b0257fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600601541415611bb9576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b6000600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020505033600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507f9d9f8dee205818414bdc412447826de8498cede62c943f209590a732b07876fb868233604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a1505050505050565b838073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614611ec957600080fd5b843373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614611fcd576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260198152602001807f596f7520617265206e6f742074686520636f772773207665740000000000000081525060200191505060405180910390fd5b85856000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206010016000838152602001908152602001600020600001541461209b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601d8152602001807f436865636b7570207265636f726420616c72656164792065786973747300000081525060200191505060405180910390fd5b876005808111156120a857fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060060154141561215f576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b604051806060016040528089815260200188815260200187815250600260008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060100160008a81526020019081526020016000206000820151816000015560208201518160010190805190602001906121f3929190614f1e565b506040820151816002019080519060200190612210929190614f1e565b50905050600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600f018890806001815401808255809150509060018203906000526020600020016000909192909190915055507fbc44d1182cc990891c266fd31f7e6ec9ae906756f5b45e5df8e49dc2721adf058988604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200180602001828103825283818151815260200191508051906020019080838360005b838110156123155780820151818401526020810190506122fa565b50505050905090810190601f1680156123425780820380516001836020036101000a031916815260200191505b50935050505060405180910390a1505050505050505050565b808073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146123f657600080fd5b813373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146124fa576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b8260058081111561250757fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006015414156125be576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720726561647920666f7220736c6175676874657200000000000000000081525060200191505060405180910390fd5b6000600260008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006015490507f1b3e506251c2ebe4ce6320d1124b8831a6f478315347287ac43f0fa82e4b191485600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a17fe3382e3265f065b7828d4764b22c8b576c015ceabd006740ca130cafebc213958582600460058111156127c457fe5b604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001838152602001828152602001935050505060405180910390a15050505050565b6000818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146128b757600080fd5b826005808111156128c457fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060060154141561297b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060080160019054906101000a900460ff1692505050919050565b828073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614612a6f57600080fd5b83836000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c016000838152602001908152602001600020600101541415612b3e576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f5061727420646f6573206e6f742065786973740000000000000000000000000081525060200191505060405180910390fd5b600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600086815260200190815260200160002060040154803414612c0a576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260128152602001807f496e73756666696369656e742066756e6473000000000000000000000000000081525060200191505060405180910390fd5b600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c016000888152602001908152602001600020505084600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600088815260200190815260200160002060000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507f1831135e73187fbb47bbe95cdf41901f8aea2c3d4721182be0e1a7397c792644878787604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018381526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a150505050505050565b818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614612eb057600080fd5b823373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614612fb4576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b6000600260008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060060154905083600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600601819055507fe3382e3265f065b7828d4764b22c8b576c015ceabd006740ca130cafebc21395858286604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001838152602001828152602001935050505060405180910390a15050505050565b60026020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060030160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060040154908060050154908060060154908060080160009054906101000a900460ff16908060080160019054906101000a900460ff16908060080160029054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060090160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169080600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508c565b6001818154811061322357fe5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146132ed57600080fd5b823373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146133f1576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16838073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614156134f7576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601c8152602001807f4c6f636174696f6e732063616e6e6f74206265207468652073616d650000000081525060200191505060405180910390fd5b8560058081111561350457fe5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206006015414156135bb576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260178152602001807f436f7720616c726561647920736c61756768746572656400000000000000000081525060200191505060405180910390fd5b6000600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905086600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507f1b3e506251c2ebe4ce6320d1124b8831a6f478315347287ac43f0fa82e4b1914888289604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a15050505050505050565b848073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461381357600080fd5b853373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614613917576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f496e76616c69642070726f63657373696e672061626174746f6972000000000081525060200191505060405180910390fd5b868680600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600083815260200190815260200160002060010154141561397c57600080fd5b6040518060e001604052808a73ffffffffffffffffffffffffffffffffffffffff1681526020018981526020018881526020018681526020018781526020018b815260200160001515815250600260008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c0160008a815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160010155604082015181600201556060820151816003019080519060200190613a92929190614f1e565b506080820151816004015560a0820151816005015560c08201518160060160006101000a81548160ff021916908315150217905550905050600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600b018890806001815401808255809150509060018203906000526020600020016000909192909190915055507f580ef7999043974948382fd91ea90c7221d387804b08ff23f172946f99481ee589898d8d604051808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018481526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200194505050505060405180910390a15050505050505050505050565b88600073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614613cef576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260168152602001807f436f7720616c726561647920726567697374657265640000000000000000000081525060200191505060405180910390fd5b8983600181518110613cfd57fe5b602002602001015184600081518110613d1257fe5b60200260200101518073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614158015613d8257508073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614155b8015613dba57508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614155b613e2c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601e8152602001807f506172656e74732f6f6666737072696e6720686176652073616d65204944000081525060200191505060405180910390fd5b6040518061020001604052808e73ffffffffffffffffffffffffffffffffffffffff1681526020013373ffffffffffffffffffffffffffffffffffffffff1681526020018d73ffffffffffffffffffffffffffffffffffffffff1681526020018c73ffffffffffffffffffffffffffffffffffffffff1681526020018b81526020018a815260200160006005811115613ec157fe5b8152602001898152602001881515815260200160001515815260200187600081518110613eea57fe5b602002602001015173ffffffffffffffffffffffffffffffffffffffff16815260200187600181518110613f1a57fe5b602002602001015173ffffffffffffffffffffffffffffffffffffffff1681526020018673ffffffffffffffffffffffffffffffffffffffff1681526020016000604051908082528060200260200182016040528015613f895781602001602082028038833980820191505090505b5081526020016000604051908082528060200260200182016040528015613fbf5781602001602082028038833980820191505090505b5081526020016000604051908082528060200260200182016040528015613ff55781602001602082028038833980820191505090505b50815250600260008f73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060408201518160020160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060608201518160030160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506080820151816004015560a0820151816005015560c0820151816006015560e082015181600701908051906020019061418e929190614f9e565b506101008201518160080160006101000a81548160ff0219169083151502179055506101208201518160080160016101000a81548160ff0219169083151502179055506101408201518160080160026101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506101608201518160090160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555061018082015181600a0160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506101a082015181600b0190805190602001906142c6929190614f9e565b506101c082015181600d0190805190602001906142e4929190614f9e565b506101e082015181600f019080519060200190614302929190614f9e565b5090505060018d90806001815401808255809150509060018203906000526020600020016000909192909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550507f4a74374c4bf0d1c7ff231237d54ccaeebf9ace2decc23671483df84c45122311338e604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019250505060405180910390a150505050505050505050505050565b823373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614614516576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f596f7520617265206e6f742074686520636f772773206f776e6572000000000081525060200191505060405180910390fd5b83836000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c0160008381526020019081526020016000206001015414156145e5576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f5061727420646f6573206e6f742065786973740000000000000000000000000081525060200191505060405180910390fd5b83600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600087815260200190815260200160002060040181905550505050505050565b818073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146146e357600080fd5b600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614614849576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601b8152602001807f496e76616c69642070726f63657373696e672061626174746f6972000000000081525060200191505060405180910390fd5b6000600260008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060060154905060058081111561489c57fe5b600260008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600601819055507f81c4f748f2b8251193f19677b64f6d41a2301d662639e52fe9740fdce53b995885600260008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600a0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1686604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a17fe3382e3265f065b7828d4764b22c8b576c015ceabd006740ca130cafebc213958582600580811115614a3e57fe5b604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001838152602001828152602001935050505060405180910390a15050505050565b828073ffffffffffffffffffffffffffffffffffffffff16600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614614b2f57600080fd5b83836000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c016000838152602001908152602001600020600101541415614bfe576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260138152602001807f5061727420646f6573206e6f742065786973740000000000000000000000000081525060200191505060405180910390fd5b8585600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600082815260200190815260200160002060060160009054906101000a900460ff1615614cd7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260118152602001807f5061727420616c726561647920736f6c6400000000000000000000000000000081525060200191505060405180910390fd5b6001600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600089815260200190815260200160002060060160006101000a81548160ff02191690831515021790555085600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600089815260200190815260200160002060000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16600260008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600c01600089815260200190815260200160002050507f8ca89f6c5215526144cf02a80f774b20d08f0268575bdef4d5e70827e79446fd8888604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a15050505050505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10614f5f57805160ff1916838001178555614f8d565b82800160010185558215614f8d579182015b82811115614f8c578251825591602001919060010190614f71565b5b509050614f9a9190614feb565b5090565b828054828255906000526020600020908101928215614fda579160200282015b82811115614fd9578251825591602001919060010190614fbe565b5b509050614fe79190614feb565b5090565b61500d91905b80821115615009576000816000905550600101614ff1565b5090565b9056fea165627a7a7230582057750439221644ef5337cce338e481fad3162930718b124680a186ce495cb51b0029';

let eventOnBornEvent = null;
let eventOnCowTransferEvent = null;
let eventOnRelocatedEvent = null;
let eventOnStatusUpdate = null;
let eventOnVeterinarianVisit = null;
let eventOnSlaughteredEvent = null;
let eventOnPackagedEvent = null;
let eventOnDistributedEvent = null;
let eventOnSoldEvent = null;
let eventOnCowForSale = null;

let abi = [{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"newVetinarian","type":"address"}],"name":"setVetinarian","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"isForSale","type":"bool"}],"name":"setCowMarketStatus","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"id","type":"uint256"},{"name":"foodType","type":"string"},{"name":"quantity","type":"uint256"}],"name":"mealReceived","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"}],"name":"transfer","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"id","type":"uint256"},{"name":"status","type":"string"},{"name":"description","type":"string"}],"name":"checkupReceived","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"}],"name":"sendToAbattoir","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"cowAddress","type":"address"}],"name":"isForSale","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"partId","type":"uint256"},{"name":"newOwner","type":"address"}],"name":"transferPart","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"newStatus","type":"uint256"}],"name":"setStatus","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"cowMapping","outputs":[{"name":"id","type":"address"},{"name":"owner","type":"address"},{"name":"farm","type":"address"},{"name":"vetinarian","type":"address"},{"name":"rfid","type":"bytes32"},{"name":"value","type":"uint256"},{"name":"status","type":"uint256"},{"name":"isMale","type":"bool"},{"name":"forSale","type":"bool"},{"name":"parentMale","type":"address"},{"name":"parentFemale","type":"address"},{"name":"abattoir","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"cowIndex","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"newLocation","type":"address"}],"name":"relocate","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"worker","type":"address"},{"name":"packaging","type":"uint256"},{"name":"cowAddress","type":"address"},{"name":"partId","type":"uint256"},{"name":"rfid","type":"bytes32"},{"name":"value","type":"uint256"},{"name":"description","type":"string"}],"name":"addCowPart","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"_farm","type":"address"},{"name":"_vetinarian","type":"address"},{"name":"_rfid","type":"bytes32"},{"name":"_value","type":"uint256"},{"name":"_cowDims","type":"uint256[]"},{"name":"_isMale","type":"bool"},{"name":"parents","type":"address[]"},{"name":"abattoirAddress","type":"address"}],"name":"born","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"partId","type":"uint256"},{"name":"newValue","type":"uint256"}],"name":"setPartValue","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"butcher","type":"address"}],"name":"slaughtered","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cowAddress","type":"address"},{"name":"partId","type":"uint256"},{"name":"newOwner","type":"address"}],"name":"buyPart","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":true,"stateMutability":"payable","type":"constructor"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":false,"name":"owner","type":"address"},{"indexed":false,"name":"cowAddress","type":"address"}],"name":"onBornEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"oldOwner","type":"address"},{"indexed":false,"name":"newOwner","type":"address"}],"name":"onCowTransferEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"oldLocation","type":"address"},{"indexed":false,"name":"newLocation","type":"address"}],"name":"onRelocatedEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"oldStatus","type":"uint256"},{"indexed":false,"name":"newStatus","type":"uint256"}],"name":"onStatusUpdate","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"status","type":"string"}],"name":"onVeterinarianVisit","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"abattoir","type":"address"},{"indexed":false,"name":"slaughteredBy","type":"address"}],"name":"onSlaughteredEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"partId","type":"uint256"},{"indexed":false,"name":"packagedBy","type":"address"},{"indexed":false,"name":"packageStation","type":"uint256"}],"name":"onPackagedEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"partId","type":"uint256"},{"indexed":false,"name":"recieveCentre","type":"address"}],"name":"onDistributedEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"partId","type":"uint256"}],"name":"onSoldEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"cowAddress","type":"address"},{"indexed":false,"name":"isForSale","type":"bool"}],"name":"onCowForSale","type":"event"}];


function initContract() {
    if (web3 == null) {
        console.log("web3 is null");
    }
    web3Contract = web3.eth.contract(abi, deployAddress);
}

function getWeb3Contract() {
    if (web3Contract === null) {
        initContract();
    }
    return web3Contract;
}

function initEventHooks() {
    if (web3Contract === null) {
        console.log("Contract is null, cannot add event hooks");
        return;
    }
    if (eventOnBornEvent === null) {
        eventOnBornEvent = web3Contract.onBornEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Cow Born", "New cow added to blockchain at address (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnCowTransferEvent === null) {
        eventOnCowTransferEvent = web3Contract.onCowTransferEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Cow Transferred", "Cow Transferred to (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnRelocatedEvent === null) {
        eventOnRelocatedEvent = web3Contract.onRelocatedEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Cow Relocated", "Cow relocated to new farm (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnStatusUpdate === null) {
        eventOnStatusUpdate = web3Contract.onStatusUpdate(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Status Update", "Cow's status has been updated (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnVeterinarianVisit === null) {
        eventOnVeterinarianVisit = web3Contract.onVeterinarianVisit(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Vetinarian Visit", "New vetinarian checkup added (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnSlaughteredEvent === null) {
        eventOnSlaughteredEvent = web3Contract.onSlaughteredEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Slaughter Event", "Cow sent to abottoir for processing (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnPackagedEvent === null) {
        eventOnPackagedEvent = web3Contract.onPackagedEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Wrap it up", "Cow parts being packaged for distribution (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnDistributedEvent === null) {
        eventOnDistributedEvent = web3Contract.onDistributedEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Parts distributed", "Cow parts distributed to buyer (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnSoldEvent === null) {
        eventOnSoldEvent = web3Contract.onSoldEvent(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Part Sale", "Cow part sold to buyer (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
    if (eventOnCowForSale === null) {
        eventOnCowForSale = web3Contract.onCowForSale(function (error, result) {
            if (!error) {
                var parent = document.getElementById("alert-container");
                if (parent) {
                    parent.innerHTML += createAlertHtml("success", "Cow Sale", "Cow market status changed (" + result.address + ")");
                }
            } else
                console.error(error);
        });
    }
}

function setActiveAccount(newAccount) {
    _activeAccount = newAccount;
    dispatchEvent(new CustomEvent('activeAccountChanged', {detail: newAccount}));
    populateAccountList();
}

function getContractAtAddress() {
    web3Contract = getWeb3Contract().at(deployAddress);
    initEventHooks();
    return web3Contract;
}

window.addEventListener('load', function () {
    populateAccountList();
});

function populateAccountList() {
    if (web3 == null) {
        console.log("web3 is null");
    }

    if (!document.getElementById("navbarProfiles")) {
        return;
    }
    // Clear stored profiles first
    $('#navbarProfiles').empty();

    // Add new profiles
    let profileDropdown = document.getElementById("navbarProfiles");
    web3.eth.accounts.forEach(account => {
        let a = document.createElement("a");
        a.classList.add("dropdown-item");
        if (_activeAccount === account) {
            a.classList.add("active");
        }
        a.href = "#";
        a.addEventListener('click', function () {
            setActiveAccount(a.text);
        });
        a.text = account;
        profileDropdown.appendChild(a);
    });

    $('#activeAccountBalance').text("(ETH " + web3.eth.getBalance(_activeAccount).c[0] + ")");
}

function createAlertHtml(type, title, text) {
    return "<div class=\"alert alert-" + type +" alert-dismissible fade show\" role=\"alert\">\n" +
        "  <strong>" + title + "</strong> " + text + ".\n" +
        "  <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n" +
        "    <span aria-hidden=\"true\">&times;</span>\n" +
        "  </button>\n" +
        "</div>";
}

function addEntriesToSelect(select_id, entries) {
    let select = document.getElementById(select_id);
    for (let i = 0; i < entries.length; i++) {
        let option = document.createElement("option");
        option.text = entries[i];
        select.add(option, i + 1);
    }
};

function addItemToList(listObject, itemValue) {
    let li = document.createElement("li");
    li.appendChild(document.createTextNode(itemValue));
    listObject.appendChild(li);
}

window.addEventListener('load', function () {
    // Get contract instance
    if (web3.eth.getCode(deployAddress) === "0x") {
        alert('No contract exists, please deploy one first to continue');
        document.querySelectorAll("a.btn.btn-primary").forEach(btn => btn.onclick = false)
    }
    getContractAtAddress();

    setActiveAccount(_activeAccount || web3.eth.accounts[0]);
    setEtherAccounts(web3.eth.accounts);

    populateAccountList();
});

function setEtherAccounts(etherAccounts) {
    _etherAccounts = etherAccounts;
    dispatchEvent(new CustomEvent('etherAccountsUpdated', {detail: etherAccounts}));
}